# wb-tech-school-hw1/SQL/window functions

## Часть 1.
Сразу оговорюсь, что в качестве имя сотрудника для данного отдела с самой высокой зарплатой `name_highest_sal` я буду выводить имя и фамилию, ведь как мы знаем, людей с одним именем в этой жизни слишком много.

Также для удобства лицезрения отдела, зарплат в нем (и сотрудников с max/min зарплатой) я буду сортировать результат по `industry`, `salary`, `id` (на случай равных зарплат в отделе).

### Решение без оконных функций.
Табличные выражения `get_maxes` и `get_employees` по сути идентичны аналогичным запросам только что сделанного пункта 3 по джойнам (там было для каждой категории продуктов найти продукт с максимальной суммой продаж, здесь – для каждого отдела найти сотрудника с максимальной зарплатой). 

Табличное выражение `get_maxes` извлекает для каждого отдела `industry` максимальную зарплату `max_salary`. 

Табличное выражение `get_employees` получает имена сотрудников `name_highest_sal` с максимальной зарплатой в каждом отделе через условие в джойне – сравнение зарплаты сотрудника `salary` в отделе`industry` с максимальной зарплатой в отделе `max_salary`. 

В финальном запросе через соединение таблицы `Salary` с табличным выражением `get_employees` по условию равенства отделов мы имеем для каждого сотрудника таблицы искомое поле `name_highest_sal`.

В задании сказано вывести сначала для максимума, потом для минимума – я и сделал 2 SQL-запроса.

### Решение с оконными функциями.
Я решил это задание для сотрудников и с max, и с min зарплатой в одном запросе, дабы просто-напросто не копировать один и тот же код (тут, что интересно: чтобы найти `name_highest_sal` можно было бы не использовать `LAST_VALUE`, а использовать `FIRST_VALUE` с убывающей сортировкой по зарплате – тогда не придется работать с `ROWS BETWEEN`). 

В `WINDOW w` я разделяю на секции (окна) по отделам `industry`, при этом внутри секции записи упорядочены по возрастанию зарплаты `salary`. Также я указываю, что фреймом будет вся секция через `ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING`. Иначе `LAST_VALUE` будет брать не имя с максимальной зарплатой в секции, а имя с максимальной зарплатой во фрейме (нас такое не устраивает). Терминология здесь используется такая, как и в прикрепленной [статье](https://antonz.ru/window-offset) с теор. материалами.

В конце концов с помощью указанных оконных функций выбираются имена сотрудников `name_lowest_sal` и `name_highest_sal`с минимальной зарплатой и максимальной зарплатой в отделе соответственно.

## Часть 2.
